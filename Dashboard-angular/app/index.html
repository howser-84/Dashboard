<!DOCTYPE html>

<head>
  <link rel="stylesheet" href="app.css">
</head>
<body>
<script type="text/javascript" ng:autobind src="http://code.angularjs.org/0.9.16/angular-0.9.16.js"></script>

<div ng:controller="TodosController">
  <input type="text" name="todoName" size="30" placeholder="Enter your todo here" ng:required />
  <input type="text" name="todoDesc" size="60" placeholder="Enter description of todo here" ng:required />

  <button ng:click="addTodo()">Add</button>

  <div class="tasks" ng:show="todos.length > 0">
    <b>Tasks to do:</b>
    <ul ng:repeat="todo in todos">
      <li>
        <div ng:controller="TodoEditorController">
          <button ng:click="todos.$remove(todo)">Delete</button>

          <span ng:hide="editorEnabled" ng:click="enableEditor()">
            <b>{{todo.name}}</b> ({{todo.description}})
          </span>

          <span ng:show="editorEnabled">
            <input type="text" size="30" name="todoName" ng:required />
            <button ng:click="save()">Ok</button>
            <button ng:click="disableEditor()">Cancel</button>
          </span>
        </div>

      </li>
    </ul>
  </div>

  <hr />
  Debug view:
  <pre>
    todos = {{todos}}
  </pre>
</div>
  <script>
      function TodosController() {
          this.todos = [{
                name: "Learn angular",
                description: "Some desc for 1st todo"},
              {
                name: "Install java",
                description: "Some desc for 2nd todo"},
              {
                name: "Uninstall ruby",
                description: "Some desc for 3rd todo"}];
      }

      TodosController.prototype = {
          addTodo: function() {
              if (this.todoName === "" || this.todoDesc === "") {
                  return false;
              }

              this.todos.push({
                  name: this.todoName,
                  description: this.todoDesc
              });

              this.todoName = '';
              this.todoDesc = '';
          }
      };

      function TodoEditorController() {
          this.editorEnabled = false;
      }

      TodoEditorController.prototype = {
          enableEditor: function() {
              this.editorEnabled = true;

              this.todoName = this.todo.name;
              this.todoDesc = this.todo.description;
          },

          disableEditor: function() {
              this.editorEnabled = false;
          },

          save: function() {
              if (this.todoName === "" || this.todoDesc === "") {
                  return false;
              }

              this.todo.name = this.todoName;
              this.todo.description = this.todoDesc;

              this.disableEditor();
          }
      };
  </script>
</body>
</html>
